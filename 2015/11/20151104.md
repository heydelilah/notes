转义
=====================

#### 背景：

没对 `<script>` 转义

#### 解决：

- `jquery` 中用 `.text()` 而非 `.html()`;
- `lodash` 中用 `<%-` , 而非 `<%= `

#### 转码和转义

要看在什么语境下。

前端提及"转义"，往往指的是 html 转义字符串，即针对像 “<” 和 “>” 这类已用来表示HTML标签的符号，就不能直接当做文本中的符号来使用。比如 "<" 就应该转义成 "&lt;"

而有时候提“转义”，其实是指转码？比如转成 Unicode 。

#### HTML 转义符

`&lt;`, `&gt;`, `&amp;`, `&quot;`, `&copy;`。 分别是`<`，`>`，`&`，`"`，`©`的转义字符；

#### ASCII 和 Unicode

1. `Unicode` 为每种语言中的每个字符设定了统一并且唯一的二进制编码，以满足跨语言、跨平台进行文本转换、处理的要求。

	- U+003C < Less-than sign
	- U+003E > Greater-than sign

2. `ASCII` 是基于拉丁字母的一套电脑编码系统，主要用于显示现代英语和其他西欧语言。


#### 关于 JSON

- 前端 `JSON.stringify()` 把 JavaScript 值转成 JSON 字符串；如：'[1,"false",false]'
- 后端做 JSON序列化时候，会把字符转成 `Unicode` 编码格式；如 '<' 转成 '\u003c'


#### escape() 函数

1. escape() 函数可对字符串进行编码，这样就可以在所有的计算机上读取该字符串。
2. 该方法不会对 ASCII 字母和数字进行编码，也不会对下面这些 ASCII 标点符号进行编码： * @ - _ + . / 。其他所有的字符都会被转义序列替换。


#### 如果前端表单在保存时，想手动转义的话：

	function encodeHTML(a) {
	    return String(a)
	        .replace(/&/g, "&amp;")
	        .replace(/</g, "&lt;")
	        .replace(/>/g, "&gt;")
	        .replace(/"/g, "&quot;")
	        .replace(/'/g, "&#39;");
	}

如果保存时和展示时，都做转义处理，注意会被转义了两次。


#### url

- web 开发中通过问号（？）方式在浏览器地址栏中传值时。浏览器是通过“&”来区分问号后的参数个数的。 如果出现传值参数中带有“&”时，在接受页面就会出现错误，类似如下请求路径：/next.jsp?param1=hendhs89&furej & param2=sss
- 参数param1中含有转义字符“&” ，这样会导致被请求页的参数接收错误。
- 在传值前 通过 java.net.URLEncoder.encode(param1) 编码处理后，可将转义字符转为16进制;





